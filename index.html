<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Check In</title>
    <style>
        body { font-family: sans-serif; padding: 20px; background: #f0f0f0; text-align: center; }
        .status { margin-top: 50px; padding: 20px; background: white; border-radius: 8px; box-shadow: 0 2px 5px rgba(0,0,0,0.1); }
        h1 { color: #333; }
        p { color: #666; }
    </style>
</head>
<body>

    <div class="status">
        <h1 id="title">Initializing...</h1>
        <p id="details">Please allow location access to continue.</p>
    </div>

    <script>
        // --- CONFIGURATION ---
        const CONFIG = {
            // I extracted this from your link:
            FORM_ID: '1FAIpQLSfPo8rchVQJZxVNSp_0Buqy-e7sAgBA5OSQK6yO7W0223Dvzg', 
            
            // PASTE YOUR NUMBER HERE (Look for the number after 'entry.' in your link):
            ENTRY_ID: 'REPLACE_WITH_NUMBER_HERE' 
        };

        const title = document.getElementById('title');
        const details = document.getElementById('details');

        function getLocation() {
            if (!navigator.geolocation) {
                title.innerText = "Error";
                details.innerText = "Geolocation not supported.";
                return;
            }

            // High Accuracy settings
            navigator.geolocation.getCurrentPosition(success, error, {
                enableHighAccuracy: true,
                timeout: 10000,
                maximumAge: 0
            });
        }

        function success(position) {
            const lat = position.coords.latitude;
            const lng = position.coords.longitude;
            const acc = position.coords.accuracy;
            const time = new Date().toISOString();

            // Create the Google Maps link
            const mapLink = `http://maps.google.com/?q=${lat},${lng}`;
            
            // Format the log string
            const logData = `[${time}] Acc: ${acc}m | ${mapLink}`;

            title.innerText = "Locating...";
            details.innerText = `Found location (${acc}m accuracy). Sending...`;

            sendToGoogle(logData);
        }

        function error(err) {
            title.innerText = "Location Error";
            details.innerText = err.message;
        }

        async function sendToGoogle(data) {
            const formUrl = `https://docs.google.com/forms/d/e/${CONFIG.FORM_ID}/formResponse`;
            const params = new URLSearchParams();
            
            // This maps the data to your specific question
            params.append(`entry.${CONFIG.ENTRY_ID}`, data);

            try {
                await fetch(formUrl, {
                    method: 'POST',
                    mode: 'no-cors',
                    headers: { 'Content-Type': 'application/x-www-form-urlencoded' },
                    body: params
                });

                title.innerText = "Success";
                details.innerText = "Location logged safely.";

            } catch (e) {
                title.innerText = "Network Error";
                details.innerText = e.message;
            }
        }

        // Start
        getLocation();

    </script>
</body>
</html>
